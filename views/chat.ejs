<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CHAT</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon_io/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon_io/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon_io/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <!-- <link rel="stylesheet" href="/style.css" /> -->
  <link rel="stylesheet" href="/theme.css" />
  <link rel="stylesheet" href="/globals.css" />
  <link rel="stylesheet" href="/chat_view.css" />
  <script src="https://kit.fontawesome.com/60cddcb918.js" crossorigin="anonymous"></script>
  <script src="/mouse-events.js" defer></script>
</head>

<body>
  <section class="nav">
    <div class="nav-btns flx-center-row">
      <button type="button" class="cta-menu primary" onclick="location.href='/signup'">
        <i class="fa-solid fa-user fa-xl"></i>
      </button>
      <button type="button" class="cta-menu primary"><i class="fa-solid fa-graduation-cap fa-xl"></i></button>
    </div>

    <div class="chat-logo flx-center-row">
      <img src="/logo_sm.svg" alt="Logo" />
    </div>

  </section>

  <section class="chat-container">
    <article class="flx-center-col">
      <div class="msg-bubble">
  <% if (messages && messages.length) { %>
    <% (messages || []).forEach(msg => { %>
      <div class="message-row <%= msg.sender === 'Bot' ? 'bot' : 'user' %>">
        <img src="<%= msg.avatar %>" alt="avatar" class="avatar" />
        <p class="message <%= msg.sender === 'Bot' ? 'bot' : 'user' %>"><%= msg.text %></p>
      </div>
    <% }) %>
  <% } %>
      </div>
    </article>

    <form method="POST" action="/chat" class="flx-center-row">
      <% if (typeof error !=='undefined' && error) { %>
        <div class="error-message">
          <strong>Error:</strong> <%= error %>
        </div>
        <% } %>
          <div class="input-textfield flx-center-row">
            <input class="ask-input" type="text" name="message" placeholder="Ask me anything" aria-label="Chat message"
              maxlength="500" value="<%= typeof lastMessage !== 'undefined' ? lastMessage : '' %>" />
            <button class="submit-btn" type="submit">
              <span class="iconify masked-cont" data-icon="_custom-icons/sparkle.svg">
            </button>
    </div>
    </form>


  </section>

  <div class="dot" id="dot" aria-hidden="true"></div>
</body>

</html>